"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function getCurrentDate(e){var t=e.getDate();t<10&&(t="0"+t);var n=e.getMonth()+1;n<10&&(n="0"+n);var r=e.getFullYear();return r<10&&(r="0"+r),"".concat(t,".").concat(n,".").concat(r)}var xhr=new XMLHttpRequest;xhr.open("GET","./json/db_town.json",!0),xhr.onreadystatechange=function(){if(4===xhr.readyState)if(200!==xhr.status)console.log("Error",xhr.status,xhr.statusText);else{var e=function(){var e=document.querySelectorAll(".option_result");[].forEach.call(e,function(e){e.addEventListener("click",function(){n.value=this.innerText,r.innerHTML="",r.style.visibility="hidden"})})};console.log("Ok",xhr.responseText);var t=JSON.parse(xhr.responseText),n=document.querySelector(".form_select"),r=document.querySelector(".select_result"),o=[];t.forEach(function(e){o.push(e.city)}),n.addEventListener("input",function(){var t=new RegExp(this.value,"i");if(r.innerHTML="",r.style.visibility="hidden",this.value.length>2)for(var n=0;n<o.length;n++)if(o[n].match(t)){var a=document.createElement("p");a.setAttribute("class","option_result"),r.appendChild(a),a.innerHTML+=o[n],r.style.visibility="visible",e()}})}},xhr.send();var Builder=function(){function e(){_classCallCheck(this,e),this.formId=null,this.formClass=null,this.name="",this.tel="",this.email="",this.text=""}return _createClass(e,[{key:"render",value:function(){return this.formId}}]),e}(),Form=function(e){function t(e,n,r,o,a,i,u){var l;return _classCallCheck(this,t),l=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)),l.formId=e,l.formClass=n,l.name=r,l.tel=o,l.email=a,l.text=i,l.bird=u,l}return _inherits(t,e),_createClass(t,[{key:"validate",value:function(e,t){for(var n=0;n<e.length;n++){var r=document.querySelector(".form_"+e[n]),o=/./;switch(e[n]){case"name":o=objVal.name;break;case"tel":o=objVal.tel;break;case"email":o=objVal.email;break;case"bird":o=objVal.bird;break;case"select":o=objVal.town}o.test(r.value)?r.style.borderColor="green":(r.style.borderColor="red",t.target==r&&$("#"+r.id).effect("bounce","slow"))}}},{key:"example",value:function(){objInput.inputName.value=this.name,objInput.inputTel.value=this.tel,objInput.inputEmail.value=this.email,document.forms.form.form_textarea.value=this.text,objInput.inputBird.value=this.bird}}]),t}(Builder),objInput={inputName:document.forms.form.form_name,inputTel:document.forms.form.form_tel,inputEmail:document.forms.form.form_email,inputBird:document.forms.form.form_bird,inputTown:document.forms.form.form_select},objVal={name:/^[a-zа-яё]{2,}$/i,tel:/^(\+7\(\d{3}\)\d{3}-\d{4})$/,email:/^([a-z0-9_]+)?(-|.)([a-z0-9_]+)@([a-z0-9_]{2,5})[.]([[a-z]{2,6})$/i,bird:/^\d{2}.\d{2}.\d{4}$/,text:/.{0,200}/i,town:/[а-яё]+/i};document.forms.form.addEventListener("input",function(e){e.preventDefault(),new Form("form","form",objInput.inputName.value,objInput.inputTel.value,objInput.inputEmail.value,document.forms.form.form_textarea.value,objInput.inputBird.value,objInput.inputTown.value).validate(["name","tel","email","bird","select"],e)}),document.forms.form.addEventListener("submit",function(e){e.preventDefault();var t=!1;for(var n in objInput)objInput[n].value.trim()?objVal.name.test(objInput.inputName.value)&&objVal.tel.test(objInput.inputTel.value)&&objVal.email.test(objInput.inputEmail.value)&&objVal.bird.test(objInput.inputBird.value)&&objVal.town.test(objInput.inputTown.value)&&(t=!0):objInput[n].style.borderColor="red";if(!0===t){for(var r in objInput)objInput[r].value="",document.forms.form.form_textarea.value="",document.forms.form.form_select.value="",objInput[r].style.borderColor="#ccc";var o=document.querySelector(".form_submit"),a=document.createElement("span");o.appendChild(a),a.innerText="Форма успешно отправлена",setTimeout(function(){document.querySelector("span").remove(),setTimeout(function(){document.forms.form.submit()})},800)}}),document.querySelector(".form_button").addEventListener("contextmenu",function(e){e.preventDefault();var t=new XMLHttpRequest;t.open("GET","./json/db.json",!0),t.onreadystatechange=function(){if(4===t.readyState)if(200!==t.status)console.log("Error",t.status,t.statusText);else{console.log("Ok",t.responseText);var e=JSON.parse(t.responseText);e.forEach(function(e){new Form("form","form",e.name,e.tel,e.email,e.text,e.bird).example()})}},t.send()}),$("#form_bird").val(getCurrentDate(new Date)),$(".form_bird").datepicker({dateFormat:"dd.mm.yy",dayNames:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],dayNamesMin:["ВС","ПН","ВТ","СР","ЧТ","ПТ","СБ"],monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],yearRange:"1950:2019",changeMonth:!0,changeYear:!0,firstDay:1});